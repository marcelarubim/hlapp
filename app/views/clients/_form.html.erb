<%= custom_form_for @client, html: {class: 'custom-form'} do |f| %>
  <%= render partial: 'shared/form_errors', formats: [:js], locals: { object: @client } %>

    <div class="form-group row">
      <%= f.label :business_name, 'Business Name:' %>
      <%= f.text_field :business_name, placeholder: @client.business_name, col: 'col-sm-10' %>
    </div>
    <div class="form-group row">
      <%= f.label :legal_name, 'Legal Name:' %>
      <%= f.text_field :legal_name, placeholder: @client.legal_name, col: 'col-sm-10' %>
    </div>
    <div class="form-group row">
      <%= f.label :cnpj, 'CNPJ:' %>
      <%= f.number_field :cnpj, placeholder: @client.cnpj %>
      <%= f.label :website, 'Website:' %>
      <%= f.text_field :website, placeholder: @client.website %>
    </div>
    <div class="form-group row">
      <%= f.label :telephone, 'Telephone:' %>
      <%= f.text_field :telephone, placeholder: @client.telephone %>
      <%= f.label :fax, 'Fax:' %>
      <%= f.text_field :fax, placeholder: @client.fax %>
    </div>
    <div class="form-group row">
      <%= f.label :welcome_letter, 'Welcome letter:' %>
      <%= f.date_field :welcome_letter, placeholder: @client.welcome_letter %>
      <%= f.label :month_anniversary, 'Anniversary month:' %>
      <%= f.month_field :month_anniversary, value: @client.month_anniversary%>
    </div>
    <div class="form-group row">
      <%= f.label :referrer, 'Referrer:' %>
      <%= f.text_area :referrer, placeholder: @client.referrer %>
    </div>
    <div class="form-group row">
      <%= label_tag 'client_category_sector', 'Sector:'%>
      <div class="col-sm-4"><%= select_tag "client_category_sector", options_from_collection_for_select(ClientCategory.all.select(:sector).distinct.order(:sector), "sector", "sector", selected: @client.category&.sector), include_blank: true %></div>
      <%= f.label :category_id, 'Category:' %>
      <div class="col-sm-4"><%= f.collection_select :category_id, @client.new_record? ? ClientCategory.all.select(:id, :name) : [@client.category], :id, :name, {include_blank: true}, selected: @client.category&.name %></div>
    </div>
    <fieldset id="category_attributes" disabled>
      <div class="form-group row">
        <%= f.fields_for :category, ClientCategory.new do |ff| %>
            <%= ff.label :sector, 'New sector:' %>
            <%= ff.text_field :sector, placeholder: 'Sector' %>
            <%= ff.label :name, 'New category:' %>
            <%= ff.text_field :name, placeholder: 'Name'%>
        <% end %>
      </div>
    </fieldset>

    <div class="form-group row">
      <%= label_tag 'new_category', 'New category?' %>
      <div class="col-sm-10">
        <div class="form-check">
          <label class="form-check-label">
            <input class="form-check-input" type="checkbox" id="new_category">
          </label>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <%= f.label :seller_id, 'Seller:' %>
      <div class="col-sm-2"><%= f.collection_select :seller_id, User.all, :id, :fullname, selected: @client.seller&.id, include_blank: true %></div>
      <%= f.label :captured_by_id, 'Captured by:' %>
      <div class="col-sm-2"><%= f.collection_select :captured_by_id, User.all, :id, :fullname, selected: @client.captured_by&.id, include_blank: true %></div>
      <%= f.label :telemarketing_id, 'Telemarketing:' %>
      <div class="col-sm-2"><%= f.collection_select :telemarketing_id, User.all, :id, :fullname, selected: @client.telemarketing&.id, include_blank: true %></div>
    </div>

    <% unless @client.new_record? %>
      <p class="mt-3">Contracts:</p>
      <div id="contract-container">
        <%= render partial: "contracts", locals: {f: f} %>
      </div>
      <%= link_to "New contract", new_client_contract_path(@client)%>
    <% end %>

    <p class="mt-3">Addresses:</p>
    <div id="address-container">
      <%= f.fields_for :addresses, @client.addresses do |ff| %>
        <%= render partial: "addresses", locals: {ff: ff} %>
      <% end %>
    </div>
    <%= link_to_add_fields("New address", f, 'addresses') %>

    <p class="mt-3">Contacts:</p>
    <div id="contact-container">
      <%= f.fields_for :contacts, @client.contacts do |ff| %>
        <%= render partial: "contacts", locals: {ff: ff} %>
      <% end %>
    </div>
    <%= link_to_add_fields("New contact", f, 'contacts') %>

    <%= f.submit 'Save', class: 'btn btn-primary px-0' %>
  <% end %>
